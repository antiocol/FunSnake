var list_1_Tuple_4_Double__Double__Double__Double__NilTuple_4_Double__Double__Double__Double_, list_1_Tuple_4_Double__Double__Double__Double__ConsTuple_4_Double__Double__Double__Double_, list_1_Double__NilDouble, list_1_Double__ConsDouble, UnfoldEnumerator_2_FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double___ctor$FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_, UnfoldEnumerator_2_Double__Double___ctor$Double_Double, Tuple_4_Double__Double__Double__Double__GeneratedCompareToDouble_Double_Double_Double, TupleTuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_, TupleDouble_Double_Double_Double, TupleDouble_Double, Seq__Unfold$FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_, Seq__Unfold$Double__Double_Double_Double, Seq__ToList$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, Seq__ToList$Double_Double, Seq__Skip$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, Seq__OfList$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, Seq__FromFactory$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, Seq__FromFactory$Double_Double, Seq__FoldIndexedAux$FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_, Seq__FoldIndexedAux$FSharpList_1_Double__Double_FSharpList_1_Double__Double, Seq__FoldIndexed$Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_, Seq__FoldIndexed$Double__FSharpList_1_Double_Double_FSharpList_1_Double_, Seq__Fold$Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_, Seq__Fold$Double__FSharpList_1_Double_Double_FSharpList_1_Double_, Seq__Enumerator$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, Seq__Enumerator$Double_Double, Range__customStep$Double__Double_Double_Double, Option__IsSome$FSharpList_1_Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double_, Option__IsSome$Double_Double, Option__GetValue$Tuple_2_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_2_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_, Option__GetValue$Tuple_2_Double__Double_Tuple_2_Double__Double_, Option__GetValue$FSharpList_1_Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double_, Option__GetValue$Double_Double, List__Tail$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, List__Reverse$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, List__Reverse$Double_Double, List__Map$Double__Tuple_4_Double__Double__Double__Double_Double_Tuple_4_Double__Double__Double__Double_, List__Iterate$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, List__FoldIndexedAux$list_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_list_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_, List__FoldIndexedAux$list_1_Tuple_4_Double__Double__Double__Double__Double_list_1_Tuple_4_Double__Double__Double__Double__Double, List__FoldIndexedAux$list_1_Double__Double_list_1_Double__Double, List__FoldIndexedAux$Unit__Tuple_4_Double__Double__Double__Double_Unit__Tuple_4_Double__Double__Double__Double_, List__FoldIndexed$Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_, List__FoldIndexed$Tuple_4_Double__Double__Double__Double__Unit_Tuple_4_Double__Double__Double__Double__Unit_, List__FoldIndexed$Double__list_1_Tuple_4_Double__Double__Double__Double_Double_list_1_Tuple_4_Double__Double__Double__Double_, List__FoldIndexed$Double__list_1_Double_Double_list_1_Double_, List__Fold$Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_, List__Fold$Tuple_4_Double__Double__Double__Double__Unit_Tuple_4_Double__Double__Double__Double__Unit_, List__Fold$Double__list_1_Tuple_4_Double__Double__Double__Double_Double_list_1_Tuple_4_Double__Double__Double__Double_, List__Fold$Double__list_1_Double_Double_list_1_Double_, List__Exists$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, List__Empty$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, List__Empty$Double_Double, List__CreateCons$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, List__CreateCons$Double_Double, List__Append$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, LanguagePrimitives__UnboxGeneric$MSPointerEvent_MSPointerEvent_, LanguagePrimitives__UnboxGeneric$HTMLCanvasElement_HTMLCanvasElement_, GenericConstants__Zero$Double_Double, FunSnake__wallTop, FunSnake__wallRight, FunSnake__wallLeft, FunSnake__wallDown, FunSnake__wall, FunSnake__update$, FunSnake__touch, FunSnake__snake, FunSnake__sizeLink, FunSnake__op_Dynamic$JQuery_JQuery_, FunSnake__newFood$, FunSnake__moveUp$Double__Double_Double_Double, FunSnake__moveRight$Double__Double_Double_Double, FunSnake__moveLeft$Double__Double_Double_Double, FunSnake__moveDown$Double__Double_Double_Double, FunSnake__moveDone, FunSnake__move$Double__Double_Double_Double, FunSnake__main$, FunSnake__jQuery$, FunSnake__hasCollision$, FunSnake__get_wallTop$, FunSnake__get_wallRight$, FunSnake__get_wallLeft$, FunSnake__get_wallDown$, FunSnake__get_wall$, FunSnake__get_touch$, FunSnake__get_snake$, FunSnake__get_sizeLink$, FunSnake__get_moveDone$, FunSnake__get_direction$, FunSnake__get_canvasSize$, FunSnake__getRandomAbsolute$, FunSnake__getColorLink$, FunSnake__drawWall$, FunSnake__drawGameOver$, FunSnake__draw$, FunSnake__direction, FunSnake__defaultGradientLink$, FunSnake__canvasSize, FunSnake__Contains$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_, Direction__Up, Direction__Right, Direction__None, Direction__Left, Direction__GeneratedCompareTo, Direction__Down, CreateEnumerable_1_Tuple_4_Double__Double__Double__Double___ctor$Tuple_4_Double__Double__Double__Double_, CreateEnumerable_1_Double___ctor$Double;
  CreateEnumerable_1_Double___ctor$Double = (function (factory)
  {
    this.factory = factory;
  });
  CreateEnumerable_1_Tuple_4_Double__Double__Double__Double___ctor$Tuple_4_Double__Double__Double__Double_ = (function (factory)
  {
    this.factory = factory;
  });
  Direction__Down = (function ()
  {
    this.Tag = 3.000000;
    this._CaseName = "Down";
  });
  Direction__GeneratedCompareTo = (function (a)
  {
    return (function (b)
    {
      var isAThisCase = (a.Tag == 0.000000);
      var isBThisCase = (b.Tag == 0.000000);
      if ((isAThisCase && isBThisCase)) 
      {
        return 0;
      }
      else
      {
        if (isAThisCase) 
        {
          return -1;
        }
        else
        {
          if (isBThisCase) 
          {
            return 1;
          }
          else
          {
            var _isAThisCase = (a.Tag == 1.000000);
            var _isBThisCase = (b.Tag == 1.000000);
            if ((_isAThisCase && _isBThisCase)) 
            {
              return 0;
            }
            else
            {
              if (_isAThisCase) 
              {
                return -1;
              }
              else
              {
                if (_isBThisCase) 
                {
                  return 1;
                }
                else
                {
                  var __isAThisCase = (a.Tag == 2.000000);
                  var __isBThisCase = (b.Tag == 2.000000);
                  if ((__isAThisCase && __isBThisCase)) 
                  {
                    return 0;
                  }
                  else
                  {
                    if (__isAThisCase) 
                    {
                      return -1;
                    }
                    else
                    {
                      if (__isBThisCase) 
                      {
                        return 1;
                      }
                      else
                      {
                        var ___isAThisCase = (a.Tag == 3.000000);
                        var ___isBThisCase = (b.Tag == 3.000000);
                        if ((___isAThisCase && ___isBThisCase)) 
                        {
                          return 0;
                        }
                        else
                        {
                          if (___isAThisCase) 
                          {
                            return -1;
                          }
                          else
                          {
                            if (___isBThisCase) 
                            {
                              return 1;
                            }
                            else
                            {
                              var ____isAThisCase = (a.Tag == 4.000000);
                              var ____isBThisCase = (b.Tag == 4.000000);
                              if ((____isAThisCase && ____isBThisCase)) 
                              {
                                return 0;
                              }
                              else
                              {
                                if (____isAThisCase) 
                                {
                                  return -1;
                                }
                                else
                                {
                                  if (____isBThisCase) 
                                  {
                                    return 1;
                                  }
                                  else
                                  {
                                    throw ("Unknown union case");
                                    return null;
                                  };
                                };
                              };
                            };
                          };
                        };
                      };
                    };
                  };
                };
              };
            };
          };
        };
      };
    });
  });
  Direction__Left = (function ()
  {
    this.Tag = 0.000000;
    this._CaseName = "Left";
  });
  Direction__None = (function ()
  {
    this.Tag = 4.000000;
    this._CaseName = "None";
  });
  Direction__Right = (function ()
  {
    this.Tag = 1.000000;
    this._CaseName = "Right";
  });
  Direction__Up = (function ()
  {
    this.Tag = 2.000000;
    this._CaseName = "Up";
  });
  FunSnake__Contains$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (e, el)
  {
    var _710;
    var predicate = (function (x)
    {
      return (Tuple_4_Double__Double__Double__Double__GeneratedCompareToDouble_Double_Double_Double(x)(e) == 0);
    });
    _710 = (function (list)
    {
      return List__Exists$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(predicate, list);
    });
    return _710(el);
  });
  FunSnake__defaultGradientLink$ = (function (ctx, link_0, link_1, link_2, link_3, colorStart, colorEnd)
  {
    var link = (new TupleDouble_Double_Double_Double(link_0, link_1, link_2, link_3));
    var y = link.Items[1.000000];
    var x = link.Items[0.000000];
    var w = link.Items[3.000000];
    var h = link.Items[2.000000];
    var gradient = (ctx.createRadialGradient((x + (w / 2.000000)), (y + (h / 2.000000)), 1.000000, (x + (w / 2.000000)), (y + (h / 2.000000)), (FunSnake__sizeLink - 4.000000)));
    (gradient.addColorStop(0.000000, colorStart));
    (gradient.addColorStop(1.000000, colorEnd));
    return gradient;
  });
  FunSnake__draw$ = (function (snake, food, hasCollision)
  {
    var canvas = LanguagePrimitives__UnboxGeneric$HTMLCanvasElement_HTMLCanvasElement_((FunSnake__op_Dynamic$JQuery_JQuery_((function (selector)
    {
      return FunSnake__jQuery$(selector);
    }), "canvas")[0]));
    var ctx = (canvas.getContext("2d"));
    (ctx.clearRect(FunSnake__sizeLink, FunSnake__sizeLink, (FunSnake__canvasSize.Items[0.000000] - FunSnake__sizeLink), (FunSnake__canvasSize.Items[1.000000] - FunSnake__sizeLink)));
    var _1511;
    var tupledArg = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake);
    var colorStart = "rgb(184,7,7)";
    var colorEnd = "white";
    var arg10_ = tupledArg.Items[0.000000];
    var arg11_ = tupledArg.Items[1.000000];
    var arg12_ = tupledArg.Items[2.000000];
    var arg13_ = tupledArg.Items[3.000000];
    _1511 = FunSnake__defaultGradientLink$(ctx, arg10_, arg11_, arg12_, arg13_, colorStart, colorEnd);
    var _1578;
    var tupledArg = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake);
    var colorStart = "rgb(184,7,7)";
    var colorEnd = "white";
    var arg10_ = tupledArg.Items[0.000000];
    var arg11_ = tupledArg.Items[1.000000];
    var arg12_ = tupledArg.Items[2.000000];
    var arg13_ = tupledArg.Items[3.000000];
    _1578 = FunSnake__defaultGradientLink$(ctx, arg10_, arg11_, arg12_, arg13_, colorStart, colorEnd);
    (ctx.fillStyle) = _1511;
    null;
    (function (_tupledArg)
    {
      var arg00 = _tupledArg.Items[0.000000];
      var arg01 = _tupledArg.Items[1.000000];
      var arg02 = _tupledArg.Items[2.000000];
      var arg03 = _tupledArg.Items[3.000000];
      return (ctx.fillRect(arg00, arg01, arg02, arg03));
    })(List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake));
    var _1618;
    var _1619;
    var action = (function (x)
    {
      var y = x.Items[1.000000];
      var _x = x.Items[0.000000];
      var w = x.Items[2.000000];
      var h = x.Items[3.000000];
      (ctx.fillStyle) = FunSnake__getColorLink$(ctx, _x, y, w, h, hasCollision, "orange", "red");
      null;
      return (ctx.fillRect(_x, y, w, h));
    });
    _1619 = (function (list)
    {
      return List__Iterate$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(action, list);
    });
    _1618 = _1619(List__Tail$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake));
    (function (value)
    {
      var ignored0 = value;
    })(_1618);
    var _1698;
    var _colorStart = "rgb(50,165,12)";
    var _colorEnd = "white";
    var _arg10_ = food.Items[0.000000];
    var _arg11_ = food.Items[1.000000];
    var _arg12_ = food.Items[2.000000];
    var _arg13_ = food.Items[3.000000];
    _1698 = FunSnake__defaultGradientLink$(ctx, _arg10_, _arg11_, _arg12_, _arg13_, _colorStart, _colorEnd);
    var _1717;
    var _colorStart = "rgb(50,165,12)";
    var _colorEnd = "white";
    var _arg10_ = food.Items[0.000000];
    var _arg11_ = food.Items[1.000000];
    var _arg12_ = food.Items[2.000000];
    var _arg13_ = food.Items[3.000000];
    _1717 = FunSnake__defaultGradientLink$(ctx, _arg10_, _arg11_, _arg12_, _arg13_, _colorStart, _colorEnd);
    (ctx.fillStyle) = _1698;
    null;
    return (function (value)
    {
      var ignored0 = value;
    })((function (_tupledArg)
    {
      var arg00 = _tupledArg.Items[0.000000];
      var arg01 = _tupledArg.Items[1.000000];
      var arg02 = _tupledArg.Items[2.000000];
      var arg03 = _tupledArg.Items[3.000000];
      return (ctx.fillRect(arg00, arg01, arg02, arg03));
    })(food));
  });
  FunSnake__drawGameOver$ = (function (unitVar0)
  {
    var canvas = LanguagePrimitives__UnboxGeneric$HTMLCanvasElement_HTMLCanvasElement_((FunSnake__op_Dynamic$JQuery_JQuery_((function (selector)
    {
      return FunSnake__jQuery$(selector);
    }), "canvas")[0]));
    var ctx = (canvas.getContext("2d"));
    (ctx.fillStyle) = "red";
    null;
    (ctx.font) = "18px Segoe UI";
    null;
    var metrics = (ctx.measureText("Game over!!!"));
    return (function (value)
    {
      var ignored0 = value;
    })((ctx.fillText("Game Over!!!", ((FunSnake__canvasSize.Items[0.000000] / 2.000000) - ((metrics.width) / 2.000000)), (FunSnake__canvasSize.Items[1.000000] / 2.000000))));
  });
  FunSnake__drawWall$ = (function (wall)
  {
    var canvas = LanguagePrimitives__UnboxGeneric$HTMLCanvasElement_HTMLCanvasElement_((FunSnake__op_Dynamic$JQuery_JQuery_((function (selector)
    {
      return FunSnake__jQuery$(selector);
    }), "canvas")[0]));
    var ctx = (canvas.getContext("2d"));
    var _570;
    var _571;
    var action = (function (x)
    {
      (ctx.fillStyle) = "black";
      null;
      var y = x.Items[1.000000];
      var _x = x.Items[0.000000];
      var w = x.Items[2.000000];
      var h = x.Items[3.000000];
      return (ctx.fillRect(_x, y, w, h));
    });
    _571 = (function (list)
    {
      return List__Iterate$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(action, list);
    });
    _570 = _571(wall);
    return (function (value)
    {
      var ignored0 = value;
    })(_570);
  });
  FunSnake__getColorLink$ = (function (ctx, link_0, link_1, link_2, link_3, collision, aliveColor, collisionColor)
  {
    var link = (new TupleDouble_Double_Double_Double(link_0, link_1, link_2, link_3));
    if (collision) 
    {
      var colorEnd = "white";
      var arg10_ = link.Items[0.000000];
      var arg11_ = link.Items[1.000000];
      var arg12_ = link.Items[2.000000];
      var arg13_ = link.Items[3.000000];
      return FunSnake__defaultGradientLink$(ctx, arg10_, arg11_, arg12_, arg13_, collisionColor, colorEnd);
    }
    else
    {
      var _colorEnd = "white";
      var _arg10_ = link.Items[0.000000];
      var _arg11_ = link.Items[1.000000];
      var _arg12_ = link.Items[2.000000];
      var _arg13_ = link.Items[3.000000];
      return FunSnake__defaultGradientLink$(ctx, _arg10_, _arg11_, _arg12_, _arg13_, aliveColor, _colorEnd);
    };
  });
  FunSnake__getRandomAbsolute$ = (function (max, absolute)
  {
    return (((window.Math).floor(((((window.Math).random()) * max) / absolute))) * absolute);
  });
  FunSnake__get_canvasSize$ = (function ()
  {
    return (new TupleDouble_Double(300.000000, 300.000000));
  });
  FunSnake__get_direction$ = (function ()
  {
    return (new Direction__None());
  });
  FunSnake__get_moveDone$ = (function ()
  {
    return true;
  });
  FunSnake__get_sizeLink$ = (function ()
  {
    return 10.000000;
  });
  FunSnake__get_snake$ = (function ()
  {
    return List__CreateCons$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_((new TupleDouble_Double_Double_Double((FunSnake__sizeLink * 5.000000), (FunSnake__sizeLink * 3.000000), FunSnake__sizeLink, FunSnake__sizeLink)), List__CreateCons$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_((new TupleDouble_Double_Double_Double((FunSnake__sizeLink * 4.000000), (FunSnake__sizeLink * 3.000000), FunSnake__sizeLink, FunSnake__sizeLink)), List__CreateCons$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_((new TupleDouble_Double_Double_Double((FunSnake__sizeLink * 3.000000), (FunSnake__sizeLink * 3.000000), FunSnake__sizeLink, FunSnake__sizeLink)), List__Empty$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_())));
  });
  FunSnake__get_touch$ = (function ()
  {
    return (new TupleDouble_Double(-1.000000, -1.000000));
  });
  FunSnake__get_wall$ = (function ()
  {
    return List__Append$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(FunSnake__wallLeft, List__Append$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(FunSnake__wallTop, List__Append$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(FunSnake__wallRight, FunSnake__wallDown)));
  });
  FunSnake__get_wallDown$ = (function ()
  {
    var _530;
    var mapping = (function (x)
    {
      return (new TupleDouble_Double_Double_Double(x, FunSnake__canvasSize.Items[1.000000], FunSnake__sizeLink, FunSnake__sizeLink));
    });
    _530 = (function (list)
    {
      return List__Map$Double__Tuple_4_Double__Double__Double__Double_Double_Tuple_4_Double__Double__Double__Double_(mapping, list);
    });
    return _530(Seq__ToList$Double_Double(Range__customStep$Double__Double_Double_Double(0.000000, FunSnake__sizeLink, FunSnake__canvasSize.Items[0.000000])));
  });
  FunSnake__get_wallLeft$ = (function ()
  {
    var _186;
    var mapping = (function (x)
    {
      return (new TupleDouble_Double_Double_Double(0.000000, x, FunSnake__sizeLink, FunSnake__sizeLink));
    });
    _186 = (function (list)
    {
      return List__Map$Double__Tuple_4_Double__Double__Double__Double_Double_Tuple_4_Double__Double__Double__Double_(mapping, list);
    });
    return _186(Seq__ToList$Double_Double(Range__customStep$Double__Double_Double_Double(0.000000, FunSnake__sizeLink, FunSnake__canvasSize.Items[1.000000])));
  });
  FunSnake__get_wallRight$ = (function ()
  {
    var _506;
    var mapping = (function (x)
    {
      return (new TupleDouble_Double_Double_Double(FunSnake__canvasSize.Items[0.000000], x, FunSnake__sizeLink, FunSnake__sizeLink));
    });
    _506 = (function (list)
    {
      return List__Map$Double__Tuple_4_Double__Double__Double__Double_Double_Tuple_4_Double__Double__Double__Double_(mapping, list);
    });
    return _506(Seq__ToList$Double_Double(Range__customStep$Double__Double_Double_Double(0.000000, FunSnake__sizeLink, FunSnake__canvasSize.Items[1.000000])));
  });
  FunSnake__get_wallTop$ = (function ()
  {
    var _481;
    var mapping = (function (x)
    {
      return (new TupleDouble_Double_Double_Double(x, 0.000000, FunSnake__sizeLink, FunSnake__sizeLink));
    });
    _481 = (function (list)
    {
      return List__Map$Double__Tuple_4_Double__Double__Double__Double_Double_Tuple_4_Double__Double__Double__Double_(mapping, list);
    });
    return _481(Seq__ToList$Double_Double(Range__customStep$Double__Double_Double_Double(0.000000, FunSnake__sizeLink, FunSnake__canvasSize.Items[0.000000])));
  });
  FunSnake__hasCollision$ = (function (snake)
  {
    var _1470;
    var _1471;
    var e = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake);
    _1471 = (function (el)
    {
      return FunSnake__Contains$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(e, el);
    });
    _1470 = _1471(FunSnake__wall);
    return (_1470 || (function ()
    {
      var _1478;
      var _e = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake);
      _1478 = (function (el)
      {
        return FunSnake__Contains$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(_e, el);
      });
      return _1478(List__Tail$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake));
    })());
  });
  FunSnake__jQuery$ = (function (selector)
  {
    return ((window.$)(selector));
  });
  FunSnake__main$ = (function (unitVar0)
  {
    ((window.window).addEventListener("keydown", (function (e)
    {
      if (FunSnake__moveDone) 
      {
        if ((((e.keyCode) == 65.000000) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Up())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Down())) == 0)))) 
        {
          FunSnake__direction = (new Direction__Left());
        }
        else
        {
          ;
        };
        if ((((e.keyCode) == 87.000000) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Right())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Left())) == 0)))) 
        {
          FunSnake__direction = (new Direction__Up());
        }
        else
        {
          ;
        };
        if ((((e.keyCode) == 68.000000) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Up())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Down())) == 0)))) 
        {
          FunSnake__direction = (new Direction__Right());
        }
        else
        {
          ;
        };
        if ((((e.keyCode) == 83.000000) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Right())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Left())) == 0)))) 
        {
          FunSnake__direction = (new Direction__Down());
        }
        else
        {
          ;
        };
        FunSnake__moveDone = false;
      }
      else
      {
        ;
      };
    })));
    var canvas = LanguagePrimitives__UnboxGeneric$HTMLCanvasElement_HTMLCanvasElement_((FunSnake__op_Dynamic$JQuery_JQuery_((function (selector)
    {
      return FunSnake__jQuery$(selector);
    }), "canvas")[0]));
    (canvas.addEventListener("pointerdown", (function (e)
    {
      var ev = LanguagePrimitives__UnboxGeneric$MSPointerEvent_MSPointerEvent_(e);
      FunSnake__touch = (new TupleDouble_Double(((ev.pageX) - (canvas.offsetLeft)), ((ev.pageY) - (canvas.offsetTop))));
    })));
    FunSnake__drawWall$(FunSnake__wall);
    var _632;
    var _633;
    var _673;
    _633 = FunSnake__newFood$(FunSnake__snake, _673);
    var tupledArg = _633;
    var _771;
    var arg20_ = _771;
    var arg10_ = tupledArg.Items[0.000000];
    var arg11_ = tupledArg.Items[1.000000];
    var arg12_ = tupledArg.Items[2.000000];
    var arg13_ = tupledArg.Items[3.000000];
    _632 = FunSnake__update$(FunSnake__snake, arg10_, arg11_, arg12_, arg13_, arg20_);
    return (function (value)
    {
      var ignored0 = value;
    })(_632);
  });
  FunSnake__move$Double__Double_Double_Double = (function (xMove, yMove, snake, food_0, food_1, food_2, food_3)
  {
    var food = (new TupleDouble_Double_Double_Double(food_0, food_1, food_2, food_3));
    if ((snake.Tag == 1.000000)) 
    {
      var y = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake).Items[1.000000];
      var x = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake).Items[0.000000];
      var w = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake).Items[3.000000];
      var h = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake).Items[2.000000];
      var newHead = (new TupleDouble_Double_Double_Double((x + xMove), (y + yMove), h, w));
      if ((Tuple_4_Double__Double__Double__Double__GeneratedCompareToDouble_Double_Double_Double(newHead)(food) == 0)) 
      {
        return List__CreateCons$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(newHead, snake);
      }
      else
      {
        var _1159;
        var _1160;
        var _1164;
        var _1236;
        var _1237;
        var count = 1;
        _1237 = (function (source)
        {
          return Seq__Skip$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(count, Seq__OfList$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(source));
        });
        _1236 = _1237((function (list)
        {
          return List__Reverse$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(list);
        })(snake));
        _1164 = (function (source)
        {
          return Seq__ToList$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(source);
        })(_1236);
        _1160 = (function (list)
        {
          return List__Reverse$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(list);
        })(_1164);
        _1159 = _1160;
        return List__CreateCons$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(newHead, _1159);
      };
    }
    else
    {
      return snake;
    };
  });
  FunSnake__moveDown$Double__Double_Double_Double = (function (snake, food_0, food_1, food_2, food_3)
  {
    var food = (new TupleDouble_Double_Double_Double(food_0, food_1, food_2, food_3));
    var xMove = 0.000000;
    var arg30_ = food.Items[0.000000];
    var arg31_ = food.Items[1.000000];
    var arg32_ = food.Items[2.000000];
    var arg33_ = food.Items[3.000000];
    return FunSnake__move$Double__Double_Double_Double(xMove, FunSnake__sizeLink, snake, arg30_, arg31_, arg32_, arg33_);
  });
  FunSnake__moveLeft$Double__Double_Double_Double = (function (snake, food_0, food_1, food_2, food_3)
  {
    var food = (new TupleDouble_Double_Double_Double(food_0, food_1, food_2, food_3));
    var xMove = (-FunSnake__sizeLink);
    var yMove = 0.000000;
    var arg30_ = food.Items[0.000000];
    var arg31_ = food.Items[1.000000];
    var arg32_ = food.Items[2.000000];
    var arg33_ = food.Items[3.000000];
    return FunSnake__move$Double__Double_Double_Double(xMove, yMove, snake, arg30_, arg31_, arg32_, arg33_);
  });
  FunSnake__moveRight$Double__Double_Double_Double = (function (snake, food_0, food_1, food_2, food_3)
  {
    var food = (new TupleDouble_Double_Double_Double(food_0, food_1, food_2, food_3));
    var yMove = 0.000000;
    var arg30_ = food.Items[0.000000];
    var arg31_ = food.Items[1.000000];
    var arg32_ = food.Items[2.000000];
    var arg33_ = food.Items[3.000000];
    return FunSnake__move$Double__Double_Double_Double(FunSnake__sizeLink, yMove, snake, arg30_, arg31_, arg32_, arg33_);
  });
  FunSnake__moveUp$Double__Double_Double_Double = (function (snake, food_0, food_1, food_2, food_3)
  {
    var food = (new TupleDouble_Double_Double_Double(food_0, food_1, food_2, food_3));
    var xMove = 0.000000;
    var yMove = (-FunSnake__sizeLink);
    var arg30_ = food.Items[0.000000];
    var arg31_ = food.Items[1.000000];
    var arg32_ = food.Items[2.000000];
    var arg33_ = food.Items[3.000000];
    return FunSnake__move$Double__Double_Double_Double(xMove, yMove, snake, arg30_, arg31_, arg32_, arg33_);
  });
  FunSnake__newFood$ = (function (snake, unitVar1)
  {
    var randomFood = (new TupleDouble_Double_Double_Double((FunSnake__getRandomAbsolute$((FunSnake__canvasSize.Items[0.000000] - (FunSnake__sizeLink * 2.000000)), FunSnake__sizeLink) + FunSnake__sizeLink), (FunSnake__getRandomAbsolute$((FunSnake__canvasSize.Items[1.000000] - (FunSnake__sizeLink * 2.000000)), FunSnake__sizeLink) + FunSnake__sizeLink), FunSnake__sizeLink, FunSnake__sizeLink));
    if ((function (el)
    {
      return FunSnake__Contains$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(randomFood, el);
    })(snake)) 
    {
      var _770;
      return FunSnake__newFood$(snake, _770);
    }
    else
    {
      return randomFood;
    };
  });
  FunSnake__op_Dynamic$JQuery_JQuery_ = (function (jq, name)
  {
    return jq(("#" + name));
  });
  FunSnake__update$ = (function (snake, food_0, food_1, food_2, food_3, unitVar2)
  {
    var food = (new TupleDouble_Double_Double_Double(food_0, food_1, food_2, food_3));
    var patternInput = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(snake);
    var sy = patternInput.Items[1.000000];
    var sx = patternInput.Items[0.000000];
    var _807;
    if ((FunSnake__touch.Items[0.000000] == -1.000000)) 
    {
      if ((FunSnake__touch.Items[1.000000] == -1.000000)) 
      {
        _807 = FunSnake__direction;
      }
      else
      {
        var _816;
        var y = FunSnake__touch.Items[1.000000];
        var x = FunSnake__touch.Items[0.000000];
        _816 = ((y < sy) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Left())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Right())) == 0)));
        if (_816) 
        {
          var _x = FunSnake__touch.Items[0.000000];
          var _y = FunSnake__touch.Items[1.000000];
          _807 = (new Direction__Up());
        }
        else
        {
          var _848;
          var __y = FunSnake__touch.Items[1.000000];
          var __x = FunSnake__touch.Items[0.000000];
          _848 = ((__y > sy) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Left())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Right())) == 0)));
          if (_848) 
          {
            var ___y = FunSnake__touch.Items[1.000000];
            var ___x = FunSnake__touch.Items[0.000000];
            _807 = (new Direction__Down());
          }
          else
          {
            var _880;
            var ____y = FunSnake__touch.Items[1.000000];
            var ____x = FunSnake__touch.Items[0.000000];
            _880 = ((____x < sx) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Up())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Down())) == 0)));
            if (_880) 
            {
              var _____y = FunSnake__touch.Items[1.000000];
              var _____x = FunSnake__touch.Items[0.000000];
              _807 = (new Direction__Left());
            }
            else
            {
              var _912;
              var ______y = FunSnake__touch.Items[1.000000];
              var ______x = FunSnake__touch.Items[0.000000];
              _912 = ((______x > sx) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Up())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Down())) == 0)));
              if (_912) 
              {
                var _______y = FunSnake__touch.Items[1.000000];
                var _______x = FunSnake__touch.Items[0.000000];
                _807 = (new Direction__Right());
              }
              else
              {
                _807 = FunSnake__direction;
              };
            };
          };
        };
      };
    }
    else
    {
      var _944;
      var ________y = FunSnake__touch.Items[1.000000];
      var ________x = FunSnake__touch.Items[0.000000];
      _944 = ((________y < sy) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Left())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Right())) == 0)));
      if (_944) 
      {
        var _________x = FunSnake__touch.Items[0.000000];
        var _________y = FunSnake__touch.Items[1.000000];
        _807 = (new Direction__Up());
      }
      else
      {
        var _976;
        var __________y = FunSnake__touch.Items[1.000000];
        var __________x = FunSnake__touch.Items[0.000000];
        _976 = ((__________y > sy) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Left())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Right())) == 0)));
        if (_976) 
        {
          var ___________y = FunSnake__touch.Items[1.000000];
          var ___________x = FunSnake__touch.Items[0.000000];
          _807 = (new Direction__Down());
        }
        else
        {
          var _1008;
          var ____________y = FunSnake__touch.Items[1.000000];
          var ____________x = FunSnake__touch.Items[0.000000];
          _1008 = ((____________x < sx) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Up())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Down())) == 0)));
          if (_1008) 
          {
            var _____________y = FunSnake__touch.Items[1.000000];
            var _____________x = FunSnake__touch.Items[0.000000];
            _807 = (new Direction__Left());
          }
          else
          {
            var _1040;
            var ______________y = FunSnake__touch.Items[1.000000];
            var ______________x = FunSnake__touch.Items[0.000000];
            _1040 = ((______________x > sx) && (((Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__None())) == 0) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Up())) == 0)) || (Direction__GeneratedCompareTo(FunSnake__direction)((new Direction__Down())) == 0)));
            if (_1040) 
            {
              var _______________y = FunSnake__touch.Items[1.000000];
              var _______________x = FunSnake__touch.Items[0.000000];
              _807 = (new Direction__Right());
            }
            else
            {
              _807 = FunSnake__direction;
            };
          };
        };
      };
    };
    FunSnake__direction = _807;
    FunSnake__touch = (new TupleDouble_Double(-1.000000, -1.000000));
    var _1075;
    if ((FunSnake__direction.Tag == 0.000000)) 
    {
      var arg10_ = food.Items[0.000000];
      var arg11_ = food.Items[1.000000];
      var arg12_ = food.Items[2.000000];
      var arg13_ = food.Items[3.000000];
      _1075 = FunSnake__moveLeft$Double__Double_Double_Double(snake, arg10_, arg11_, arg12_, arg13_);
    }
    else
    {
      if ((FunSnake__direction.Tag == 2.000000)) 
      {
        var _arg10_ = food.Items[0.000000];
        var _arg11_ = food.Items[1.000000];
        var _arg12_ = food.Items[2.000000];
        var _arg13_ = food.Items[3.000000];
        _1075 = FunSnake__moveUp$Double__Double_Double_Double(snake, _arg10_, _arg11_, _arg12_, _arg13_);
      }
      else
      {
        if ((FunSnake__direction.Tag == 3.000000)) 
        {
          var __arg10_ = food.Items[0.000000];
          var __arg11_ = food.Items[1.000000];
          var __arg12_ = food.Items[2.000000];
          var __arg13_ = food.Items[3.000000];
          _1075 = FunSnake__moveDown$Double__Double_Double_Double(snake, __arg10_, __arg11_, __arg12_, __arg13_);
        }
        else
        {
          if ((FunSnake__direction.Tag == 4.000000)) 
          {
            _1075 = snake;
          }
          else
          {
            var ___arg10_ = food.Items[0.000000];
            var ___arg11_ = food.Items[1.000000];
            var ___arg12_ = food.Items[2.000000];
            var ___arg13_ = food.Items[3.000000];
            _1075 = FunSnake__moveRight$Double__Double_Double_Double(snake, ___arg10_, ___arg11_, ___arg12_, ___arg13_);
          };
        };
      };
    };
    var _snake = _1075;
    var _1456;
    if ((Tuple_4_Double__Double__Double__Double__GeneratedCompareToDouble_Double_Double_Double(List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(_snake))(food) == 0)) 
    {
      var _1467;
      _1456 = FunSnake__newFood$(_snake, _1467);
    }
    else
    {
      _1456 = food;
    };
    var _food = _1456;
    var collision = FunSnake__hasCollision$(_snake);
    FunSnake__draw$(_snake, _food, collision);
    FunSnake__moveDone = true;
    if (collision) 
    {
      FunSnake__drawWall$(FunSnake__wall);
      FunSnake__drawGameOver$();
      return 0;
    }
    else
    {
      var _1795;
      var _1796;
      var ____arg10_ = _food.Items[0.000000];
      var ____arg11_ = _food.Items[1.000000];
      var ____arg12_ = _food.Items[2.000000];
      var ____arg13_ = _food.Items[3.000000];
      _1796 = (function (arg20_)
      {
        return FunSnake__update$(_snake, ____arg10_, ____arg11_, ____arg12_, ____arg13_, arg20_);
      });
      _1795 = (window.setTimeout(_1796, (1000.000000 / 10.000000)));
      (function (value)
      {
        var ignored0 = value;
      })(_1795);
      return 1;
    };
  });
  GenericConstants__Zero$Double_Double = (function ()
  {
    return 0;;
  });
  LanguagePrimitives__UnboxGeneric$HTMLCanvasElement_HTMLCanvasElement_ = (function (x)
  {
    return x;;
  });
  LanguagePrimitives__UnboxGeneric$MSPointerEvent_MSPointerEvent_ = (function (x)
  {
    return x;;
  });
  List__Append$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (xs, ys)
  {
    return List__Fold$Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_((function (acc)
    {
      return (function (x)
      {
        return (new list_1_Tuple_4_Double__Double__Double__Double__ConsTuple_4_Double__Double__Double__Double_(x, acc));
      });
    }), ys, List__Reverse$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(xs));
  });
  List__CreateCons$Double_Double = (function (x, xs)
  {
    return (new list_1_Double__ConsDouble(x, xs));
  });
  List__CreateCons$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (x, xs)
  {
    return (new list_1_Tuple_4_Double__Double__Double__Double__ConsTuple_4_Double__Double__Double__Double_(x, xs));
  });
  List__Empty$Double_Double = (function ()
  {
    return (new list_1_Double__NilDouble());
  });
  List__Empty$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function ()
  {
    return (new list_1_Tuple_4_Double__Double__Double__Double__NilTuple_4_Double__Double__Double__Double_());
  });
  List__Exists$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (f, _arg1)
  {
    return ((_arg1.Tag == 1.000000) && (function ()
    {
      var xs = _arg1.Item2;
      var x = _arg1.Item1;
      return (f(x) || List__Exists$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(f, xs));
    })());
  });
  List__Fold$Double__list_1_Double_Double_list_1_Double_ = (function (f, seed, xs)
  {
    return List__FoldIndexed$Double__list_1_Double_Double_list_1_Double_((function (_arg1)
    {
      return (function (acc)
      {
        return (function (x)
        {
          return f(acc)(x);
        });
      });
    }), seed, xs);
  });
  List__Fold$Double__list_1_Tuple_4_Double__Double__Double__Double_Double_list_1_Tuple_4_Double__Double__Double__Double_ = (function (f, seed, xs)
  {
    return List__FoldIndexed$Double__list_1_Tuple_4_Double__Double__Double__Double_Double_list_1_Tuple_4_Double__Double__Double__Double_((function (_arg1)
    {
      return (function (acc)
      {
        return (function (x)
        {
          return f(acc)(x);
        });
      });
    }), seed, xs);
  });
  List__Fold$Tuple_4_Double__Double__Double__Double__Unit_Tuple_4_Double__Double__Double__Double__Unit_ = (function (f, seed, xs)
  {
    return List__FoldIndexed$Tuple_4_Double__Double__Double__Double__Unit_Tuple_4_Double__Double__Double__Double__Unit_((function (_arg1)
    {
      return (function (acc)
      {
        return (function (x)
        {
          return f(acc)(x);
        });
      });
    }), seed, xs);
  });
  List__Fold$Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_ = (function (f, seed, xs)
  {
    return List__FoldIndexed$Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_((function (_arg1)
    {
      return (function (acc)
      {
        return (function (x)
        {
          return f(acc)(x);
        });
      });
    }), seed, xs);
  });
  List__FoldIndexed$Double__list_1_Double_Double_list_1_Double_ = (function (f, seed, xs)
  {
    return List__FoldIndexedAux$list_1_Double__Double_list_1_Double__Double(f, 0, seed, xs);
  });
  List__FoldIndexed$Double__list_1_Tuple_4_Double__Double__Double__Double_Double_list_1_Tuple_4_Double__Double__Double__Double_ = (function (f, seed, xs)
  {
    return List__FoldIndexedAux$list_1_Tuple_4_Double__Double__Double__Double__Double_list_1_Tuple_4_Double__Double__Double__Double__Double(f, 0, seed, xs);
  });
  List__FoldIndexed$Tuple_4_Double__Double__Double__Double__Unit_Tuple_4_Double__Double__Double__Double__Unit_ = (function (f, seed, xs)
  {
    return List__FoldIndexedAux$Unit__Tuple_4_Double__Double__Double__Double_Unit__Tuple_4_Double__Double__Double__Double_(f, 0, seed, xs);
  });
  List__FoldIndexed$Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_ = (function (f, seed, xs)
  {
    return List__FoldIndexedAux$list_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_list_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_(f, 0, seed, xs);
  });
  List__FoldIndexedAux$Unit__Tuple_4_Double__Double__Double__Double_Unit__Tuple_4_Double__Double__Double__Double_ = (function (f, i, acc, _arg1)
  {
    if ((_arg1.Tag == 1.000000)) 
    {
      var xs = _arg1.Item2;
      var x = _arg1.Item1;
      return List__FoldIndexedAux$Unit__Tuple_4_Double__Double__Double__Double_Unit__Tuple_4_Double__Double__Double__Double_(f, (i + 1), f(i)(acc)(x), xs);
    }
    else
    {
      return acc;
    };
  });
  List__FoldIndexedAux$list_1_Double__Double_list_1_Double__Double = (function (f, i, acc, _arg1)
  {
    if ((_arg1.Tag == 1.000000)) 
    {
      var xs = _arg1.Item2;
      var x = _arg1.Item1;
      return List__FoldIndexedAux$list_1_Double__Double_list_1_Double__Double(f, (i + 1), f(i)(acc)(x), xs);
    }
    else
    {
      return acc;
    };
  });
  List__FoldIndexedAux$list_1_Tuple_4_Double__Double__Double__Double__Double_list_1_Tuple_4_Double__Double__Double__Double__Double = (function (f, i, acc, _arg1)
  {
    if ((_arg1.Tag == 1.000000)) 
    {
      var xs = _arg1.Item2;
      var x = _arg1.Item1;
      return List__FoldIndexedAux$list_1_Tuple_4_Double__Double__Double__Double__Double_list_1_Tuple_4_Double__Double__Double__Double__Double(f, (i + 1), f(i)(acc)(x), xs);
    }
    else
    {
      return acc;
    };
  });
  List__FoldIndexedAux$list_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_list_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_ = (function (f, i, acc, _arg1)
  {
    if ((_arg1.Tag == 1.000000)) 
    {
      var xs = _arg1.Item2;
      var x = _arg1.Item1;
      return List__FoldIndexedAux$list_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_list_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_(f, (i + 1), f(i)(acc)(x), xs);
    }
    else
    {
      return acc;
    };
  });
  List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (_arg1)
  {
    if ((_arg1.Tag == 1.000000)) 
    {
      var xs = _arg1.Item2;
      var x = _arg1.Item1;
      return x;
    }
    else
    {
      throw ("List was empty");
      return null;
    };
  });
  List__Iterate$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (f, xs)
  {
    var _596;
    return List__Fold$Tuple_4_Double__Double__Double__Double__Unit_Tuple_4_Double__Double__Double__Double__Unit_((function (unitVar0)
    {
      return (function (x)
      {
        return f(x);
      });
    }), _596, xs);
  });
  List__Map$Double__Tuple_4_Double__Double__Double__Double_Double_Tuple_4_Double__Double__Double__Double_ = (function (f, xs)
  {
    return (function (_xs)
    {
      return List__Reverse$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(_xs);
    })(List__Fold$Double__list_1_Tuple_4_Double__Double__Double__Double_Double_list_1_Tuple_4_Double__Double__Double__Double_((function (acc)
    {
      return (function (x)
      {
        return (new list_1_Tuple_4_Double__Double__Double__Double__ConsTuple_4_Double__Double__Double__Double_(f(x), acc));
      });
    }), (new list_1_Tuple_4_Double__Double__Double__Double__NilTuple_4_Double__Double__Double__Double_()), xs));
  });
  List__Reverse$Double_Double = (function (xs)
  {
    return List__Fold$Double__list_1_Double_Double_list_1_Double_((function (acc)
    {
      return (function (x)
      {
        return (new list_1_Double__ConsDouble(x, acc));
      });
    }), (new list_1_Double__NilDouble()), xs);
  });
  List__Reverse$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (xs)
  {
    return List__Fold$Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__list_1_Tuple_4_Double__Double__Double__Double_((function (acc)
    {
      return (function (x)
      {
        return (new list_1_Tuple_4_Double__Double__Double__Double__ConsTuple_4_Double__Double__Double__Double_(x, acc));
      });
    }), (new list_1_Tuple_4_Double__Double__Double__Double__NilTuple_4_Double__Double__Double__Double_()), xs);
  });
  List__Tail$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (_arg1)
  {
    if ((_arg1.Tag == 1.000000)) 
    {
      var xs = _arg1.Item2;
      var x = _arg1.Item1;
      return xs;
    }
    else
    {
      throw ("List was empty");
      return null;
    };
  });
  Option__GetValue$Double_Double = (function (option)
  {
    return option.Value;;
  });
  Option__GetValue$FSharpList_1_Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double_ = (function (option)
  {
    return option.Value;;
  });
  Option__GetValue$Tuple_2_Double__Double_Tuple_2_Double__Double_ = (function (option)
  {
    return option.Value;;
  });
  Option__GetValue$Tuple_2_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_2_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_ = (function (option)
  {
    return option.Value;;
  });
  Option__IsSome$Double_Double = (function (option)
  {
    return ((option.Tag == 1.000000) && true);
  });
  Option__IsSome$FSharpList_1_Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double_ = (function (option)
  {
    return ((option.Tag == 1.000000) && true);
  });
  Range__customStep$Double__Double_Double_Double = (function (first, stepping, last)
  {
    var zero = GenericConstants__Zero$Double_Double();
    var _287;
    var f = (function (x)
    {
      if ((((stepping > zero) && (x <= last)) || ((stepping < zero) && (x >= last)))) 
      {
        return {Tag: 1.000000, Value: (new TupleDouble_Double(x, (x + stepping)))};
      }
      else
      {
        return {Tag: 0.000000};
      };
    });
    _287 = (function (seed)
    {
      return Seq__Unfold$Double__Double_Double_Double(f, seed);
    });
    return _287(first);
  });
  Seq__Enumerator$Double_Double = (function (xs)
  {
    return xs.GetEnumerator();
  });
  Seq__Enumerator$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (xs)
  {
    return xs.GetEnumerator();
  });
  Seq__Fold$Double__FSharpList_1_Double_Double_FSharpList_1_Double_ = (function (f, seed, xs)
  {
    return Seq__FoldIndexed$Double__FSharpList_1_Double_Double_FSharpList_1_Double_((function (_arg1)
    {
      return (function (acc)
      {
        return (function (x)
        {
          return f(acc)(x);
        });
      });
    }), seed, xs);
  });
  Seq__Fold$Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_ = (function (f, seed, xs)
  {
    return Seq__FoldIndexed$Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_((function (_arg1)
    {
      return (function (acc)
      {
        return (function (x)
        {
          return f(acc)(x);
        });
      });
    }), seed, xs);
  });
  Seq__FoldIndexed$Double__FSharpList_1_Double_Double_FSharpList_1_Double_ = (function (f, seed, xs)
  {
    return Seq__FoldIndexedAux$FSharpList_1_Double__Double_FSharpList_1_Double__Double(f, seed, Seq__Enumerator$Double_Double(xs));
  });
  Seq__FoldIndexed$Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_ = (function (f, seed, xs)
  {
    return Seq__FoldIndexedAux$FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_(f, seed, Seq__Enumerator$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(xs));
  });
  Seq__FoldIndexedAux$FSharpList_1_Double__Double_FSharpList_1_Double__Double = (function (f, acc, xs)
  {
    var i = {contents: 0};
    var _acc = {contents: acc};
    while (xs.MoveNext())
    {
      _acc.contents = f(i.contents)(_acc.contents)(xs.get_Current());
      null;
      i.contents = (i.contents + 1);
      null;
    };
    return _acc.contents;
  });
  Seq__FoldIndexedAux$FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_ = (function (f, acc, xs)
  {
    var i = {contents: 0};
    var _acc = {contents: acc};
    while (xs.MoveNext())
    {
      _acc.contents = f(i.contents)(_acc.contents)(xs.get_Current());
      null;
      i.contents = (i.contents + 1);
      null;
    };
    return _acc.contents;
  });
  Seq__FromFactory$Double_Double = (function (f)
  {
    var impl;
    impl = (new CreateEnumerable_1_Double___ctor$Double(f));
    return {GetEnumerator: (function (unitVar1)
    {
      return (function (__, unitVar1)
      {
        var _366;
        return __.factory(_366);
      })(impl, unitVar1);
    })};
  });
  Seq__FromFactory$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (f)
  {
    var impl;
    impl = (new CreateEnumerable_1_Tuple_4_Double__Double__Double__Double___ctor$Tuple_4_Double__Double__Double__Double_(f));
    return {GetEnumerator: (function (unitVar1)
    {
      return (function (__, unitVar1)
      {
        var _1326;
        return __.factory(_1326);
      })(impl, unitVar1);
    })};
  });
  Seq__OfList$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (xs)
  {
    var _1244;
    var f = (function (_arg1)
    {
      if ((_arg1.Tag == 1.000000)) 
      {
        var _xs = List__Tail$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(_arg1);
        var x = List__Head$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(_arg1);
        return {Tag: 1.000000, Value: (new TupleTuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_(x, _xs))};
      }
      else
      {
        return {Tag: 0.000000};
      };
    });
    _1244 = (function (seed)
    {
      return Seq__Unfold$FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_(f, seed);
    });
    return _1244(xs);
  });
  Seq__Skip$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (n, xs)
  {
    return Seq__FromFactory$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_((function (unitVar0)
    {
      var _enum = Seq__Enumerator$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(xs);
      for (var _1340 = 1; _1340 <= n; _1340++)
      {
        (function (i)
        {
          (function (value)
          {
            var ignored0 = value;
          })(_enum.MoveNext());
        })(_1340);
      };
      return _enum;
    }));
  });
  Seq__ToList$Double_Double = (function (xs)
  {
    return (function (list)
    {
      return List__Reverse$Double_Double(list);
    })(Seq__Fold$Double__FSharpList_1_Double_Double_FSharpList_1_Double_((function (acc)
    {
      return (function (x)
      {
        return List__CreateCons$Double_Double(x, acc);
      });
    }), List__Empty$Double_Double(), xs));
  });
  Seq__ToList$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_ = (function (xs)
  {
    return (function (list)
    {
      return List__Reverse$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(list);
    })(Seq__Fold$Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_((function (acc)
    {
      return (function (x)
      {
        return List__CreateCons$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(x, acc);
      });
    }), List__Empty$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_(), xs));
  });
  Seq__Unfold$Double__Double_Double_Double = (function (f, seed)
  {
    return Seq__FromFactory$Double_Double((function (unitVar0)
    {
      var impl;
      impl = (new UnfoldEnumerator_2_Double__Double___ctor$Double_Double(seed, f));
      return {get_Current: (function (unitVar1)
      {
        return (function (__, unitVar1)
        {
          return __.current;
        })(impl, unitVar1);
      }), Dispose: (function (unitVar1)
      {
        return (function (__, unitVar1)
        {
          ;
        })(impl, unitVar1);
      }), MoveNext: (function (unitVar1)
      {
        return (function (__, unitVar1)
        {
          var next = (function (_unitVar0)
          {
            var currAcc = Option__GetValue$Double_Double(__.acc);
            var x = __.unfold(currAcc);
            if ((x.Tag == 1.000000)) 
            {
              var value = Option__GetValue$Tuple_2_Double__Double_Tuple_2_Double__Double_(x).Items[0.000000];
              var nextAcc = Option__GetValue$Tuple_2_Double__Double_Tuple_2_Double__Double_(x).Items[1.000000];
              __.acc = {Tag: 1.000000, Value: nextAcc};
              __.current = value;
              return true;
            }
            else
            {
              __.acc = {Tag: 0.000000};
              __.current = null;
              return false;
            };
          });
          return (Option__IsSome$Double_Double(__.acc) && (function ()
          {
            var _345;
            return next(_345);
          })());
        })(impl, unitVar1);
      }), Reset: (function (unitVar1)
      {
        return (function (__, unitVar1)
        {
          __.acc = {Tag: 1.000000, Value: __.seed};
          __.current = null;
        })(impl, unitVar1);
      })};
    }));
  });
  Seq__Unfold$FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_ = (function (f, seed)
  {
    return Seq__FromFactory$Tuple_4_Double__Double__Double__Double_Tuple_4_Double__Double__Double__Double_((function (unitVar0)
    {
      var impl;
      impl = (new UnfoldEnumerator_2_FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double___ctor$FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_(seed, f));
      return {get_Current: (function (unitVar1)
      {
        return (function (__, unitVar1)
        {
          return __.current;
        })(impl, unitVar1);
      }), Dispose: (function (unitVar1)
      {
        return (function (__, unitVar1)
        {
          ;
        })(impl, unitVar1);
      }), MoveNext: (function (unitVar1)
      {
        return (function (__, unitVar1)
        {
          var next = (function (_unitVar0)
          {
            var currAcc = Option__GetValue$FSharpList_1_Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double_(__.acc);
            var x = __.unfold(currAcc);
            if ((x.Tag == 1.000000)) 
            {
              var value = Option__GetValue$Tuple_2_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_2_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_(x).Items[0.000000];
              var nextAcc = Option__GetValue$Tuple_2_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_Tuple_2_Tuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_(x).Items[1.000000];
              __.acc = {Tag: 1.000000, Value: nextAcc};
              __.current = value;
              return true;
            }
            else
            {
              __.acc = {Tag: 0.000000};
              __.current = null;
              return false;
            };
          });
          return (Option__IsSome$FSharpList_1_Tuple_4_Double__Double__Double__Double_FSharpList_1_Tuple_4_Double__Double__Double__Double_(__.acc) && (function ()
          {
            var _1305;
            return next(_1305);
          })());
        })(impl, unitVar1);
      }), Reset: (function (unitVar1)
      {
        return (function (__, unitVar1)
        {
          __.acc = {Tag: 1.000000, Value: __.seed};
          __.current = null;
        })(impl, unitVar1);
      })};
    }));
  });
  TupleDouble_Double = (function (Item0, Item1)
  {
    this.Items = [Item0, Item1];
    this.Items = [Item0, Item1];
  });
  TupleDouble_Double_Double_Double = (function (Item0, Item1, Item2, Item3)
  {
    this.Items = [Item0, Item1, Item2, Item3];
    this.Items = [Item0, Item1, Item2, Item3];
    this.Items = [Item0, Item1, Item2, Item3];
    this.Items = [Item0, Item1, Item2, Item3];
  });
  TupleTuple_4_Double__Double__Double__Double__FSharpList_1_Tuple_4_Double__Double__Double__Double_ = (function (Item0, Item1)
  {
    this.Items = [Item0, Item1];
    this.Items = [Item0, Item1];
  });
  Tuple_4_Double__Double__Double__Double__GeneratedCompareToDouble_Double_Double_Double = (function (a)
  {
    return (function (b)
    {
      var diff = (a.Items[0.000000] < b.Items[0.000000] ? -1 : (a.Items[0.000000] == b.Items[0.000000] ? 0 : 1));
      if ((diff != 0)) 
      {
        return diff;
      }
      else
      {
        var _diff = (a.Items[1.000000] < b.Items[1.000000] ? -1 : (a.Items[1.000000] == b.Items[1.000000] ? 0 : 1));
        if ((_diff != 0)) 
        {
          return _diff;
        }
        else
        {
          var __diff = (a.Items[2.000000] < b.Items[2.000000] ? -1 : (a.Items[2.000000] == b.Items[2.000000] ? 0 : 1));
          if ((__diff != 0)) 
          {
            return __diff;
          }
          else
          {
            var ___diff = (a.Items[3.000000] < b.Items[3.000000] ? -1 : (a.Items[3.000000] == b.Items[3.000000] ? 0 : 1));
            if ((___diff != 0)) 
            {
              return ___diff;
            }
            else
            {
              return 0;
            };
          };
        };
      };
    });
  });
  UnfoldEnumerator_2_Double__Double___ctor$Double_Double = (function (seed, unfold)
  {
    this.seed = seed;
    this.unfold = unfold;
    this.acc = {Tag: 1.000000, Value: this.seed};
    this.current = null;
  });
  UnfoldEnumerator_2_FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double___ctor$FSharpList_1_Tuple_4_Double__Double__Double__Double__Tuple_4_Double__Double__Double__Double_ = (function (seed, unfold)
  {
    this.seed = seed;
    this.unfold = unfold;
    this.acc = {Tag: 1.000000, Value: this.seed};
    this.current = null;
  });
  list_1_Double__ConsDouble = (function (Item1, Item2)
  {
    this.Tag = 1.000000;
    this._CaseName = "Cons";
    this.Item1 = Item1;
    this.Item2 = Item2;
  });
  list_1_Double__NilDouble = (function ()
  {
    this.Tag = 0.000000;
    this._CaseName = "Nil";
  });
  list_1_Tuple_4_Double__Double__Double__Double__ConsTuple_4_Double__Double__Double__Double_ = (function (Item1, Item2)
  {
    this.Tag = 1.000000;
    this._CaseName = "Cons";
    this.Item1 = Item1;
    this.Item2 = Item2;
  });
  list_1_Tuple_4_Double__Double__Double__Double__NilTuple_4_Double__Double__Double__Double_ = (function ()
  {
    this.Tag = 0.000000;
    this._CaseName = "Nil";
  });
  FunSnake__moveDone = FunSnake__get_moveDone$();
  FunSnake__direction = FunSnake__get_direction$();
  FunSnake__touch = FunSnake__get_touch$();
  FunSnake__sizeLink = FunSnake__get_sizeLink$();
  FunSnake__canvasSize = FunSnake__get_canvasSize$();
  FunSnake__wallLeft = FunSnake__get_wallLeft$();
  FunSnake__wallTop = FunSnake__get_wallTop$();
  FunSnake__wallRight = FunSnake__get_wallRight$();
  FunSnake__wallDown = FunSnake__get_wallDown$();
  FunSnake__wall = FunSnake__get_wall$();
  FunSnake__snake = FunSnake__get_snake$();
  FunSnake__main$()